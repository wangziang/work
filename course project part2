---
title: "Statistical Inference - Course Project Part2"
date: "Thursday, October 23, 2014"
output: pdf_document
---

Introduction
------------
The purp ose of this rep ort is to analyze the effects of Vitamin C and delivery methods of Vitamin C on toothgrowth in guinea pigs. The data set is provided within the datasets package provided by the R programming language.

Data description
----------------
The ToothGrowth dataset is included in R and represents the length of odontoblasts (teeth) in each of 10 guinea pigs at each of three dose levels of Vitamin C (0.5, 1, and 2 mg) with each of two delivery methods (orange juice or ascorbic acid).

Loading the data
---------------
Loading data from dataset and showing the first few rows:

```{r}
library(datasets)
data(ToothGrowth)
head(ToothGrowth)
```

Basic summary of the data
-------------------------
Quantile characteristics for the first and third columns (Tooth length and Dose of Vitamic C in mg) for different delivery methods:

```{r}
summary(ToothGrowth[ToothGrowth$supp == "OJ",c(1,3)])
summary(ToothGrowth[ToothGrowth$supp == "VC",c(1,3)])
```

Here is boxblot for different devivery methods and doses. It looks like the more is dose, the longer teeth are. Orange juice as a delivery method looks better (in sence of longer teeth) than ascorbid acid, in most cases.
l
```{r}
boxplot(len ~ dose, data = ToothGrowth, boxwex = 0.3, at = 1:3 - 0.2,
         subset = supp == "VC", col = "green", main = "Dose and delivery 
method comparison", xlab = "Vitamin C dose mg",
         ylab = "tooth length", xlim = c(0.5, 3.5))
boxplot(len ~ dose, data = ToothGrowth, boxwex = 0.3, at = 1:3 + 0.2,
        subset = supp == "OJ", col = "red", add = TRUE)
legend(2.5, 14, c("Ascorbic acid", "Orange juice"), fill = c("green", "red"))
```

Statistical analysis
-------------------
First of all, split the variables by dose and delivery method:

```{r}
l <- split(ToothGrowth$len, list(as.factor(ToothGrowth$dose), ToothGrowth$supp))
names(l)
```

We are about to test hypothesis about means equality in different cases. We assume that teeth length variables in every case are normal IID. We use t-test because the number of observations is quite low.

Let's start with comparing different delivery methods with equal doses. The null hypothesis is that means for different delivery methods are the same, the alternative hypothesis we accept\ reject depends on comparison between test statistic and t-quantile:
```{r}
t.test(l[[1]]-l[[4]])$statistic
t.test(l[[2]]-l[[5]])$statistic
t.test(l[[3]]-l[[6]])$statistic

qt(.95, 9, lower.tail = F)
qt(.975, 9)
```

From this, we conclude that in cases of dose = 0.5mg and 1mg, the mean of teeth length is larger with 95% confidence if delivery method is orange juice (because t-statistic is less than appropriate quantile). In case of 2mg dose, means are approximately the same - we does not reject the null hypothesis because t-statistic is absolutely less than appropriate two-side quantile.

Confidence intervals of all these cases:
```{r}
t.test(l[[1]]-l[[4]])$conf.int
t.test(l[[2]]-l[[5]])$conf.int
t.test(l[[3]]-l[[6]])$conf.int
```

In addition, let us compare two cases which are pretty close according to the figure:

0.5mg dose orange juice vs. 1mg dose ascorbic acid

```{r}
tt <- t.test(l[[1]]-l[[5]])
tt$statistic
tt$conf.int
```

1mg dose orange juice vs. 2mg dose ascorbic acid

```{r}
tt <- t.test(l[[2]]-l[[6]])
tt$statistic
tt$conf.int
```

It can be clearly seen that in both these cases, ascorbic acid leads to longer teeth with 95% confidence, because both intervals does not include zero.

Conclusion
----------

In assumption that teeth length variables in every case (of dose and delivery method) are distributed normally identically and independent, we can conclude that Guinea Pigs' teeth are approximately (with 95% confidence) identically long in case of 2mg dose for both delivery methods . For lesser doses (0.5mg and 1mg), the bigger is dose, the longer are teeth; in case of equal little doses, the orange juice leads to longer teeth.
